{"version":3,"sources":["../../src/core.js"],"names":["on","off","offset","outerWidth","outerHeight","handleMouseMoveDocument","getActivateDelay","activate","ReactDOM","require","MOUSE_LOCS_TRACKED","DELAY","TOLERANCE","MenuAimModel","data","mousemoveListener","mouseLocs","menuAimModel","el","eventName","callback","addEventListener","attachEvent","e","call","window","event","removeEventListener","detachEvent","left","top","rect","getBoundingClientRect","document","body","scrollTop","scrollLeft","_width","offsetWidth","style","currentStyle","getComputedStyle","parseInt","marginLeft","_height","offsetHeight","push","x","pageX","y","pageY","length","shift","config","menu","findDOMNode","querySelector","menuSelector","menuOffset","upperLeft","tolerance","upperRight","lowerLeft","lowerRight","loc","prevLoc","_lastDelayDoc","slope","a","b","decreasingCorner","increasingCorner","submenuDirection","decreasingSlope","increasingSlope","prevDecreasingSlope","prevIncreasingSlope","_lastDelayLoc","delay","rowIdentifier","handler"],"mappings":"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","file":"core.js","sourcesContent":["/**\n * react-menu-aim is a React Mixin heavily inspired by jQuery-menu-aim. All rights\n * reserved by the original author.\n *\n * https://github.com/jasonslyvia/react-menu-aim\n * https://github.com/kamens/jQuery-menu-aim\n*/\n\nvar ReactDOM = require('react-dom');\nvar MOUSE_LOCS_TRACKED = 3;   // number of past mouse locations to trackv\nvar DELAY = 300;              // ms delay when user appears to be entering submenu\nvar TOLERANCE = 75;           // bigger = more forgivey when entering submenu\n\n\n// Consider multiple instance using ReactMenuAim, we just listen mousemove once\n// export let mousemoveListener = 0;\n// export let mouseLocs = [];\n\nexport class MenuAimModel {\n  data = {\n    mousemoveListener: 0,\n    mouseLocs: [],\n  }\n\n  mousemoveListener = 0;\n  mouseLocs = [];\n\n\n  // get(key) {\n  //   return this.data['key'];\n  // }\n\n  // set(key, value) {\n  //   this.data['key'] = value;\n  // }\n};\n\nexport const menuAimModel = new MenuAimModel();\n\n/**\n *\n * DOM helpers\n *\n */\nexport function on(el, eventName, callback) {\n  if (el.addEventListener) {\n    el.addEventListener(eventName, callback, false);\n  }\n  else if (el.attachEvent) {\n    el.attachEvent('on'+eventName, function(e) {\n      callback.call(el, e || window.event);\n    });\n  }\n}\n\nexport function off(el, eventName, callback) {\n  if (el.removeEventListener) {\n    el.removeEventListener(eventName, callback);\n  }\n  else if (el.detachEvent) {\n    el.detachEvent('on'+eventName, callback);\n  }\n}\n\nexport function offset(el) {\n  if (!el) {\n    return {\n      left: 0,\n      top: 0\n    };\n  }\n\n  var rect = el.getBoundingClientRect();\n  return {\n    top: rect.top + document.body.scrollTop,\n    left: rect.left + document.body.scrollLeft\n  };\n}\n\nexport function outerWidth(el) {\n  var _width = el.offsetWidth;\n  var style = el.currentStyle || getComputedStyle(el);\n\n  _width += (parseInt(style.marginLeft, 10) || 0);\n  return _width;\n}\n\nexport function outerHeight(el) {\n  var _height = el.offsetHeight;\n  var style = el.currentStyle || getComputedStyle(el);\n\n  _height += (parseInt(style.marginLeft, 10) || 0);\n  return _height;\n}\n\n\n\n/**\n *\n * Util helpers\n *\n */\n\n// Mousemove handler on document\nexport function handleMouseMoveDocument(e) {\n  menuAimModel.mouseLocs.push({\n    x: e.pageX,\n    y: e.pageY\n  });\n\n  if (menuAimModel.mouseLocs.length > MOUSE_LOCS_TRACKED) {\n    menuAimModel.mouseLocs.shift();\n  }\n}\n\nexport function getActivateDelay(config) {\n  config = config || {};\n  var menu = ReactDOM.findDOMNode(this);\n\n  // If can't find any DOM node\n  if (!menu || !menu.querySelector) {\n    return 0;\n  }\n  menu = config.menuSelector ? menu.querySelector(config.menuSelector) : menu;\n  var menuOffset = offset(menu);\n\n  var upperLeft = {\n    x: menuOffset.left,\n    y: menuOffset.top - (config.tolerance || TOLERANCE)\n  };\n  var upperRight = {\n    x: menuOffset.left + outerWidth(menu),\n    y: upperLeft.y\n  };\n  var lowerLeft = {\n    x: menuOffset.left,\n    y: menuOffset.top + outerHeight(menu) + (config.tolerance || TOLERANCE)\n  };\n  var lowerRight = {\n    x: menuOffset.left + outerWidth(menu),\n    y: lowerLeft.y\n  };\n\n  var loc = menuAimModel.mouseLocs[menuAimModel.mouseLocs.length - 1];\n  var prevLoc = menuAimModel.mouseLocs[0];\n\n  if (!loc) {\n    return 0;\n  }\n\n  if (!prevLoc) {\n    prevLoc = loc;\n  }\n\n  // If the previous mouse location was outside of the entire\n  // menu's bounds, immediately activate.\n  if (prevLoc.x < menuOffset.left || prevLoc.x > lowerRight.x ||\n      prevLoc.y < menuOffset.top || prevLoc.y > lowerRight.y\n    ) {\n    return 0;\n  }\n\n  // If the mouse hasn't moved since the last time we checked\n  // for activation status, immediately activate.\n  if (this._lastDelayDoc &&\n        loc.x === this._lastDelayDoc.x && loc.y === this._lastDelayDoc.y) {\n    return 0;\n  }\n\n  // Detect if the user is moving towards the currently activated\n  // submenu.\n  //\n  // If the mouse is heading relatively clearly towards\n  // the submenu's content, we should wait and give the user more\n  // time before activating a new row. If the mouse is heading\n  // elsewhere, we can immediately activate a new row.\n  //\n  // We detect this by calculating the slope formed between the\n  // current mouse location and the upper/lower right points of\n  // the menu. We do the same for the previous mouse location.\n  // If the current mouse location's slopes are\n  // increasing/decreasing appropriately compared to the\n  // previous's, we know the user is moving toward the submenu.\n  //\n  // Note that since the y-axis increases as the cursor moves\n  // down the screen, we are looking for the slope between the\n  // cursor and the upper right corner to decrease over time, not\n  // increase (somewhat counterintuitively).\n  function slope(a, b) {\n    return (b.y - a.y) / (b.x - a.x);\n  }\n\n  var decreasingCorner = upperRight;\n  var increasingCorner = lowerRight;\n\n  // Our expectations for decreasing or increasing slope values\n  // depends on which direction the submenu opens relative to the\n  // main menu. By default, if the menu opens on the right, we\n  // expect the slope between the cursor and the upper right\n  // corner to decrease over time, as explained above. If the\n  // submenu opens in a different direction, we change our slope\n  // expectations.\n  if (config.submenuDirection === 'left') {\n    decreasingCorner = lowerLeft;\n    increasingCorner = upperLeft;\n  }\n  else if (config.submenuDirection === 'below') {\n    decreasingCorner = lowerRight;\n    increasingCorner = lowerLeft;\n  }\n  else if (config.submenuDirection === 'above') {\n    decreasingCorner = upperLeft;\n  }\n\n\n  var decreasingSlope = slope(loc, decreasingCorner);\n  var increasingSlope = slope(loc, increasingCorner);\n  var prevDecreasingSlope = slope(prevLoc, decreasingCorner);\n  var prevIncreasingSlope = slope(prevLoc, increasingCorner);\n\n  // Mouse is moving from previous location towards the\n  // currently activated submenu. Delay before activating a\n  // new menu row, because user may be moving into submenu.\n  if (decreasingSlope < prevDecreasingSlope && increasingSlope > prevIncreasingSlope) {\n    this._lastDelayLoc = loc;\n    return config.delay || DELAY;\n  }\n\n  this._lastDelayLoc = null;\n  return 0;\n}\n\n\n// For the concern of further changes might happen when activeRowIndex changes,\n// this mixin doesn't setState directly, instead it calls the callback provided\n// by user.\nexport function activate(rowIdentifier, handler) {\n  handler.call(this, rowIdentifier);\n}\n"]}